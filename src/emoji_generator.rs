use rand::Rng;

/// A module for generating random sets of emojis
pub struct EmojiGenerator {
    emojis: Vec<&'static str>,
}

impl EmojiGenerator {
    /// Create a new EmojiGenerator with a default set of emojis
    pub fn new() -> Self {
        Self {
            emojis: vec![
                // Faces
                "ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„", "ðŸ˜", "ðŸ˜†", "ðŸ˜…", "ðŸ¤£", "ðŸ˜‚", "ðŸ™‚", "ðŸ™ƒ", "ðŸ˜‰", "ðŸ˜Š", "ðŸ˜‡", "ðŸ‡§ðŸ‡©",
                "ðŸ˜ˆ", "ðŸ¤©", "âœ…", "ðŸ¤–", "ðŸ‘¨ðŸ¾â€ðŸ’»", "ðŸ¤¯", "ðŸ˜‹", "ðŸ˜›", "ðŸ˜œ", "ðŸ¤ª", "ðŸ˜", "ðŸ¤‘", "ðŸ¤—", "ðŸ¤­",
                "ðŸ¤«", "ðŸ¤”", "ðŸ¤", "ðŸ¤¨", "ðŸ˜", "ðŸ˜‘", "ðŸ˜¶", "ðŸ˜", "ðŸ˜’", "ðŸ™„", "ðŸ˜¬", "ðŸ¤¥",
                // Animals
                "ðŸ¶", "ðŸ±", "ðŸ­", "ðŸ¹", "ðŸ°", "ðŸ¦Š", "ðŸ»", "ðŸ¼", "ðŸ¨", "ðŸ¯", "ðŸ¦", "ðŸ®", "ðŸ·", "ðŸ¸",
                "ðŸµ", "ðŸ™ˆ", "ðŸ™‰", "ðŸ™Š", "ðŸ’", "ðŸ”", "ðŸ§", "ðŸ¦", "ðŸ¤", "ðŸ£", "ðŸ¥", "ðŸ¦†", "ðŸ¦…", "ðŸ¦‰",
                "ðŸ¦‡", "ðŸº", "ðŸ—", "ðŸ´", "ðŸ¦„", "ðŸ", "ðŸ›", "ðŸ¦‹", "ðŸŒ", "ðŸž", "ðŸœ", "ðŸ¦Ÿ",
                // Food
                "ðŸŽ", "ðŸ", "ðŸŠ", "ðŸ‹", "ðŸŒ", "ðŸ‰", "ðŸ‡", "ðŸ“", "ðŸ«", "ðŸˆ", "ðŸ’", "ðŸ‘", "ðŸ¥­", "ðŸ",
                "ðŸ¥¥", "ðŸ¥", "ðŸ…", "ðŸ†", "ðŸ¥‘", "ðŸ¥¦", "ðŸ¥¬", "ðŸ¥’", "ðŸŒ¶ï¸", "ðŸ«‘", "ðŸŒ½", "ðŸ¥•", "ðŸ«’", "ðŸ§„",
                "ðŸ§…", "ðŸ¥”", "ðŸž", "ðŸ¥", "ðŸ¥–", "ðŸ«“", "ðŸ¥¨", "ðŸ¥¯", "ðŸ¥ž", "ðŸ§‡", "ðŸ§€", "ðŸ–",
                // Activities
                "âš½", "ðŸ€", "ðŸˆ", "âš¾", "ðŸ¥Ž", "ðŸŽ¾", "ðŸ", "ðŸ‰", "ðŸ¥", "ðŸŽ±", "ðŸª€", "ðŸ“", "ðŸ¸", "ðŸ’",
                "ðŸ‘", "ðŸ¥", "ðŸ", "ðŸªƒ", "ðŸ¥…", "â›³", "ðŸª", "ðŸ¹", "ðŸŽ£", "ðŸ¤¿", "ðŸ¥Š", "ðŸ¥‹", "ðŸŽ½", "ðŸ›¹",
                "ðŸ›·", "â›¸ï¸", // Objects
                "âŒš", "ðŸ“±", "ðŸ“²", "ðŸ’»", "âŒ¨ï¸", "ðŸ–¥ï¸", "ðŸ–¨ï¸", "ðŸ–±ï¸", "ðŸ–²ï¸", "ðŸ•¹ï¸", "ðŸ—œï¸", "ðŸ’½", "ðŸ’¾", "ðŸ’¿",
                "ðŸ“€", "ðŸ“¼", "ðŸ“·", "ðŸ“¸", "ðŸ“¹", "ðŸŽ¥", "ðŸ“ž", "â˜Žï¸", "ðŸ“Ÿ", "ðŸ“ ", "ðŸ“º", "ðŸ“»", "ðŸŽ™ï¸", "ðŸŽšï¸",
                "ðŸŽ›ï¸", "ðŸ§­", // Weather
                "â˜€ï¸", "ðŸŒ¤ï¸", "â›…", "ðŸŒ¥ï¸", "â˜ï¸", "ðŸŒ¦ï¸", "ðŸŒ§ï¸", "â›ˆï¸", "ðŸŒ©ï¸", "ðŸŒ¨ï¸", "â„ï¸", "â˜ƒï¸", "â›„", "ðŸŒ¬ï¸",
                "ðŸ’¨", "ðŸŒªï¸", "ðŸŒ«ï¸", "ðŸŒŠ", "ðŸ’§", "ðŸ’¦", // Nature
                "ðŸŒ±", "ðŸŒ¿", "â˜˜ï¸", "ðŸ€", "ðŸŽ", "ðŸŽ‹", "ðŸƒ", "ðŸ‚", "ðŸ", "ðŸŒ¾", "ðŸŒµ", "ðŸŒ´", "ðŸŒ³", "ðŸŒ²",
                // Places
                "ðŸ ", "ðŸ¡", "ðŸ¢", "ðŸ£", "ðŸ¤", "ðŸ¥", "ðŸ¦", "ðŸ¨", "ðŸ©", "ðŸª", "ðŸ«", "ðŸ¬", "ðŸ­", "ðŸ¯",
                "ðŸ°", "ðŸ—ï¸", "ðŸ˜ï¸", "ðŸšï¸", "ðŸŒ‡", "ðŸŒ†", "ðŸŒƒ", "ðŸŒ‰", "ðŸŒŒ", "ðŸ—¼", "ðŸ—½", "â›ª", "ðŸ•Œ",
                // Transportation
                "ðŸš—", "ðŸš•", "ðŸš™", "ðŸšŒ", "ðŸšŽ", "ðŸŽï¸", "ðŸš“", "ðŸš‘", "ðŸš’", "ðŸš", "ðŸšš", "ðŸš›", "ðŸšœ",
                "ðŸš²", "ðŸ›´", "ðŸ›µ", "ðŸï¸", "ðŸš¨", "ðŸš”", "ðŸš", "ðŸš˜", "ðŸš–", "ðŸš¡", "ðŸš ", "ðŸšŸ", "ðŸšƒ",
                "ðŸš‹", "ðŸš", "ðŸš„", "ðŸš…", "ðŸšˆ", "ðŸš‚", "ðŸš†", "ðŸš‡", "ðŸšŠ", "âœˆï¸", "ðŸ›©ï¸", "ðŸ›«", "ðŸ›¬",
                // Technology
                "ðŸ›°ï¸", "ðŸš€", "ðŸ›¸", "ðŸ’º", "ðŸš", "ðŸš¤", "â›µ", "ðŸ›³ï¸", "âš“", "â›½", "ðŸš§", "ðŸš¦", "ðŸš¥",
                "ðŸ›‘", "ðŸš", "ðŸ—ºï¸", "ðŸ—¿", "ðŸ´â€â˜ ï¸", "ðŸ³ï¸â€ðŸŒˆ", "ðŸ³ï¸â€âš§ï¸", "ðŸ", "ðŸš©", "ðŸŽŒ", "ðŸ³ï¸",
            ],
        }
    }

    /// Generate a random set of unique emojis (no duplicates)
    pub fn generate(&self, count: usize) -> Vec<String> {
        let mut rng = rand::rng();
        let max_count = std::cmp::min(count, self.emojis.len());

        let mut indices: Vec<usize> = (0..self.emojis.len()).collect();

        // Fisher-Yates shuffle
        for i in (1..indices.len()).rev() {
            let j = rng.random_range(0..=i);
            indices.swap(i, j);
        }

        indices
            .into_iter()
            .take(max_count)
            .map(|i| self.emojis[i].to_string())
            .collect()
    }
}

impl Default for EmojiGenerator {
    fn default() -> Self {
        Self::new()
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_generate_set() {
        let generator = EmojiGenerator::new();
        let emojis = generator.generate(5);
        assert_eq!(emojis.len(), 5);
    }
}
